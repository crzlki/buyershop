(window.webpackJsonp=window.webpackJsonp||[]).push([["chunk-873dde30"],{1936:function(t,s,e){},"731d":function(t,s,e){},7861:function(t,s,e){"use strict";var i={props:{time:{default:1718977559428},type:{default:"goodsDetail",type:String}},data(){return{end:"",hours:"",minutes:"",seconds:"",interval:""}},mounted(){this.init()},methods:{countDown(t){function s(t){return t<10?"0"+t:t+""}var e=new Date,t=new Date(t),t=parseInt((t.getTime()-e.getTime())/1e3),e=parseInt(t/3600%24),i=parseInt(t/60%60),a=parseInt(t%60),e=s(e),i=s(i),a=s(a);this.hours=e,this.minutes=i,this.seconds=a,t<=0&&(this.end="活动已结束",clearInterval(this.interval))},init(){this.interval=setInterval(()=>{this.countDown(this.time)},1e3)}}},e=(e("a01a"),e("2877")),e=Object(e.a)(i,function(){var t=this,s=t.$createElement,s=t._self._c||s;return s("div",["goodsDetail"===t.type?s("div",{staticClass:"wrapper"},[s("div",{staticClass:"wr-l"},[s("Icon",{attrs:{size:"23",type:"ios-alarm-outline"}}),t._v(" 秒杀活动")],1),""===t.end?s("div",{staticClass:"count-down"},[s("p",[t._v("倒计时：")]),s("span",[t._v(t._s(t.hours))]),s("span",[t._v(t._s(t.minutes))]),s("span",[t._v(t._s(t.seconds))])]):s("div",[t._v(t._s(t.end))])]):s("span",{staticClass:"cart-promotion"},[""===t.end?s("span",[t._v("距活动结束："),s("span",[t._v(t._s(t.hours))]),t._v(" : "),s("span",[t._v(t._s(t.minutes))]),t._v(" : "),s("span",[t._v(t._s(t.seconds))])]):s("span",[t._v("活动已结束")])])])},[],!1,null,"d6d9a094",null);s.a=e.exports},9669:function(t,s,e){"use strict";e("1936")},a01a:function(t,s,e){"use strict";e("731d")},de55:function(t,s,e){"use strict";e("e47a")},e47a:function(t,s,e){},f68e:function(t,s,e){"use strict";e.r(s);var i=e("7861"),a=e("c106"),o=e("2166"),c=e("8194"),a={name:"Cart",beforeRouteEnter(t,s,e){window.scrollTo(0,0),e()},components:{Search:a.a,Promotion:i.a},data(){return{couponAvailable:!1,stepIndex:0,goodsTotal:0,checkedNum:0,allChecked:!1,loading:!1,cartList:[],couponList:[],priceDetailDTO:{},skuList:[]}},methods:{goGoodsDetail(t,s){t=this.$router.resolve({path:"/goodsDetail",query:{skuId:t,goodsId:s}});window.open(t.href,"_blank")},goShopPage(t){t=this.$router.resolve({path:"/Merchant",query:{id:t}});window.open(t.href,"_blank")},collectGoods(t){this.$Modal.confirm({title:"收藏",content:"<p>商品收藏后可在个人中心我的收藏查看</p>",onOk:()=>{c.o("GOODS",t).then(t=>{t.success&&(this.$Message.success("收藏商品成功"),this.getCartList())})},onCancel:()=>{}})},delGoods(t){const s=[];if(t)s.push(t);else{const t=this.cartList;t.forEach(t=>{t.skuList.forEach(t=>{t.checked&&s.push(t.goodsSku.id)})})}this.$Modal.confirm({title:"删除",content:"<p>确定要删除该商品吗？</p>",onOk:()=>{o.h({skuIds:s.toString()}).then(t=>{t.success?(this.$Message.success("删除成功"),this.getCartList()):this.$Message.error(t.message)})}})},clearCart(){this.$Modal.confirm({title:"提示",content:"<p>确定要清空购物车吗？清空后不可恢复</p>",onOk:()=>{o.e().then(t=>{t.success?(this.$Message.success("清空购物车成功"),this.getCartList()):this.$Message.error(t.message)})}})},pay(){this.checkedNum?this.$router.push({path:"/pay",query:{way:"CART"}}):this.$Message.warning("请至少选择一件商品")},showCoupon(t,s){this.couponAvailable=s},changeNum(t,s){t&&o.l({skuId:s,num:t}).then(t=>{t.success&&this.getCartList()})},async changeChecked(t,s,e){t=t?1:0;"all"===s?await o.m({checked:t}):"shop"===s?await o.o({checked:t,storeId:e}):await o.n({checked:t,skuId:e}),this.getCartList()},async receiveShopCoupon(t){var s=await c.N(t.id);s.success?(this.$set(t,"disabled",!0),this.$Message.success("领取成功")):this.$Message.error(s.message)},async getCartList(){this.loading=!0;try{var t=await o.c();if(this.loading=!1,t.success){this.cartList=t.result.cartList,this.priceDetailDTO=t.result.priceDetailDTO,this.skuList=t.result.skuList;let s=!(this.checkedNum=0);for(let e=0;e<this.cartList.length;e++){let t=this.cartList[e],s=await c.r({storeId:t.storeId});t.couponList.push(...s.result.records)}for(let t=0;t<this.skuList.length;t++)this.skuList[t].checked?this.checkedNum+=this.skuList[t].num:s=!1;this.$forceUpdate(),this.allChecked=s}}catch(t){this.loading=!1}}},mounted(){this.getCartList(),o.b().then(t=>{t.success&&(this.goodsTotal=t.result)})}},i=(e("de55"),e("9669"),e("2877")),e=Object(i.a)(a,function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("div",{staticClass:"cart",on:{click:function(t){e.couponAvailable=!1}}},[i("BaseHeader"),i("div",{staticClass:"cart-content width_1200 center"},[i("div",{staticClass:"available-area"},[i("div",{staticClass:"cart-steps"},[i("span",{class:0==e.stepIndex?"active":""},[e._v("1.我的购物车")]),i("Icon",{class:0==e.stepIndex?"active-arrow":"",attrs:{custom:"icomoon icon-next"}}),i("span",{class:1==e.stepIndex?"active":""},[e._v("2.填写订单信息")]),i("Icon",{class:1==e.stepIndex?"active-arrow":"",attrs:{custom:"icomoon icon-next"}}),i("span",{class:2==e.stepIndex?"active":""},[e._v("3.成功提交订单")])],1)]),i("div",{staticClass:"cart-goods"},[i("div",{staticClass:"cart-goods-title"},[i("div",{staticClass:"width_60"},[i("Checkbox",{on:{"on-change":function(t){return e.changeChecked(e.allChecked,"all")}},model:{value:e.allChecked,callback:function(t){e.allChecked=t},expression:"allChecked"}},[e._v("全选")])],1),i("div",{staticClass:"goods-title"},[e._v("商品")]),i("div",{staticClass:"width_150"},[e._v("单价（元）")]),i("div",{staticClass:"width_100"},[e._v("数量")]),i("div",{staticClass:"width_150"},[e._v("小计")]),i("div",{staticClass:"width_100"},[e._v("操作")])]),0===e.cartList.length?i("div",{staticClass:"cart-empty"},[i("p",[e._v("购物车空空如也")]),i("router-link",{attrs:{to:"/"}},[e._v("去选购>")])],1):e._l(e.cartList,function(s,t){return i("div",{key:t,staticClass:"cart-goods-items"},[i("div",{staticClass:"shop-name"},[i("div",[i("Checkbox",{on:{"on-change":function(t){return e.changeChecked(s.checked,"shop",s.storeId)}},model:{value:s.checked,callback:function(t){e.$set(s,"checked",t)},expression:"shop.checked"}}),i("span",{staticClass:"go-shop-page",on:{click:function(t){return e.goShopPage(s.storeId)}}},[e._v(e._s(s.storeName))])],1),i("div",{staticClass:"promotion-notice"},[e._v(e._s(s.promotionNotice))])]),e._l(s.skuList,function(s,t){return[i("div",{key:t,staticClass:"goods-item"},[i("div",{staticClass:"width_60"},[i("Checkbox",{on:{"on-change":function(t){return e.changeChecked(s.checked,"goods",s.goodsSku.id)}},model:{value:s.checked,callback:function(t){e.$set(s,"checked",t)},expression:"goods.checked"}})],1),i("div",{staticClass:"goods-title",on:{click:function(t){return e.goGoodsDetail(s.goodsSku.id,s.goodsSku.goodsId)}}},[i("img",{attrs:{src:s.goodsSku.thumbnail||"../assets/images/goodsDetail/item-detail-1.jpg"}}),i("div",[i("p",[e._v(" "+e._s(s.goodsSku.goodsName)+" ")]),i("p",["WHOLESALE"===s.goodsSku.salesModel?i("Tag",{staticClass:"goods-show-tag",attrs:{color:"purple"}},[e._v(" 批发商品 ")]):e._e()],1),e._l(s.promotions,function(t,s){return["SECKILL"===t.promotionType?i("div",{key:s,staticClass:"promotion"},[i("span",[e._v("秒杀")]),i("promotion",{attrs:{time:t.endTime,type:"cart"}})],1):e._e()]}),e._l(s.promotions,function(t,s){return["FULL_DISCOUNT"===t.promotionType?i("div",{key:s,staticClass:"promotion"},[i("span",[e._v("满优惠活动")]),i("promotion",{attrs:{time:t.endTime,type:"cart"}})],1):e._e()]})],2)]),i("div",{staticClass:"width_150"},[e._v(" "+e._s(e._f("unitPrice")(s.purchasePrice,"￥"))+" ")]),i("div",{staticClass:"width_100"},[i("InputNumber",{attrs:{min:1,size:"small"},on:{"on-change":function(t){return e.changeNum(s.num,s.goodsSku.id)}},model:{value:s.num,callback:function(t){e.$set(s,"num",t)},expression:"goods.num"}}),i("div",{staticClass:"fontsize_12"},[e._v(" "+e._s(0<s.goodsSku.quantity?"有货":"无货")+" ")])],1),i("div",{staticClass:"width_150"},[e._v(" "+e._s(e._f("unitPrice")(s.subTotal,"￥"))+" ")]),i("div",{staticClass:"width_100"},[s.errorMessage?e._e():i("Button",{attrs:{size:"small",type:"primary"},on:{click:function(t){return e.delGoods(s.goodsSku.id)}}},[e._v("删除")]),s.errorMessage?e._e():i("Button",{staticStyle:{"margin-left":"10px"},attrs:{size:"small",type:"info"},on:{click:function(t){return e.collectGoods(s.goodsSku.id)}}},[e._v("收藏")])],1),s.errorMessage?i("div",{staticClass:"error-goods"},[i("div",{staticStyle:{"margin-top":"20px"}},[e._v(e._s(s.errorMessage))]),i("Button",{attrs:{type:"primary"},on:{click:function(t){return e.delGoods(s.goodsSku.id)}}},[e._v("删除")])],1):e._e()])]})],2)}),i("div",{staticClass:"cart-goods-footer"},[i("div",[i("div",{staticClass:"width_60"},[i("Checkbox",{on:{"on-change":function(t){return e.changeChecked(e.allChecked,"all")}},model:{value:e.allChecked,callback:function(t){e.allChecked=t},expression:"allChecked"}},[e._v("全选")])],1),i("div",{staticClass:"width_100 handle-btn",on:{click:function(t){return e.delGoods()}}},[e._v(" 删除选中商品 ")]),i("div",{staticClass:"width_100 handle-btn",on:{click:e.clearCart}},[e._v(" 清空购物车 ")])]),i("div",[i("div",{staticClass:"selected-count"},[e._v(" 已选择"),i("span",[e._v(e._s(e.checkedNum))]),e._v("件商品 ")]),i("div",{staticClass:"ml_20 save-price"},[e._v(" 已节省"),i("span",[e._v(e._s(e._f("unitPrice")(e.priceDetailDTO.discountPrice,"￥")))])]),i("div",{staticClass:"ml_20 total-price"},[e._v(" 总价（不含运费）: "),i("div",[e._v(e._s(e._f("unitPrice")(e.priceDetailDTO.flowPrice,"￥")))]),i("span",{staticClass:"right-price"},[e._v(" +"+e._s(e._f("unitPrice")(e.priceDetailDTO.flowPrice,"$")))]),i("TokenIcon")],1),i("div",{staticClass:"pay ml_20",on:{click:e.pay}},[e._v("去结算")])])])],2),e.loading?i("Spin",{attrs:{size:"large",fix:""}}):e._e()],1),i("BaseFooter")],1)},[],!1,null,"29f5d089",null);s.default=e.exports}}]);